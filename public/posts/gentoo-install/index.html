<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Gentoo Installation Guide (Beginner) | Zakk's Blog</title><meta name=keywords content="Gentoo,Linux,OpenRC,systemd,KDE,GNOME,SSH,Wayland,Btrfs,UEFI,NVIDIA,AMD,Intel,iwd,wpa_supplicant"><meta name=description content="
  
  
    💻 My Hardware (Example)
    0. Download & Create Installation Media
      
        0.1 Download ISO (example: NCHC Taiwan)
        0.2 Create USB Install Disk
      
    
    1. Boot & Network
      
        1.1 Check UEFI / BIOS
        1.2 Wired Network
        1.3 Wi‑Fi
      
    
    2. Partitioning (lsblk and cfdisk)
    3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs)
      
        3.1 Format
        3.2 Mount
      
    
    4. Download Stage3, Mount System Directories & chroot
      
        4.1 Stage3 Choice
        4.2 Download & Extract
        4.3 Mount System Directories
        4.4 Enter chroot
      
    
    5. Portage & Mirrors (with full make.conf example)
      
        5.1 Sync Portage
        5.2 Choose Mirrors
        5.3 /etc/portage/make.conf Example
      
    
    6. USE flags & Licenses (Beginner Solutions)
      
        6.1 Check USE
        6.2 Add USE safely
        6.3 Add License
        6.4 Keywords (optional newer versions)
      
    
    7. Profile Selection (Desktop / Server)
    8. Localization (Language & Timezone)
    9. Kernel Selection & Compilation (Full Commands)
    10. Generate fstab (ext4 / Btrfs examples)
    11. Install Bootloader GRUB (with os-prober)
    12. Enable Networking (OpenRC / systemd)
    13. Wayland / X11 Choice & USE
    14. GPU Drivers & CPU Microcode
    15. Desktop Environments (Optional)
    16. Users & sudo
    17. SSH (Optional)
    18. Reboot
  


💻 My Hardware (Example)

CPU: AMD Ryzen 9 7950X3D (16C/32T)
Motherboard: ASUS ROG STRIX X670E-A GAMING WIFI
RAM: 64GB DDR5
GPU: NVIDIA RTX 4080 SUPER + AMD iGPU
Storage: NVMe SSD
Dual boot: Windows 11 + Gentoo


Example only. Steps apply to most x86_64 hardware."><meta name=author content><link rel=canonical href=https://zakk.au/posts/gentoo-install/><link crossorigin=anonymous href=/assets/css/stylesheet.643885fd8480d5564c70ecbcd3a455f033104015abf6975cbd4cb0ea3b0445ad.css integrity="sha256-ZDiF/YSA1VZMcOy806RV8DMQQBWr9pdcvUyw6jsERa0=" rel="preload stylesheet" as=style><link rel=icon href=https://zakk.au/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zakk.au/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zakk.au/favicon-32x32.png><link rel=apple-touch-icon href=https://zakk.au/apple-touch-icon.png><link rel=mask-icon href=https://zakk.au/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zakk.au/posts/gentoo-install/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://zakk.au/posts/gentoo-install/"><meta property="og:site_name" content="Zakk's Blog"><meta property="og:title" content="Gentoo Installation Guide (Beginner)"><meta property="og:description" content=" 💻 My Hardware (Example) 0. Download & Create Installation Media 0.1 Download ISO (example: NCHC Taiwan) 0.2 Create USB Install Disk 1. Boot & Network 1.1 Check UEFI / BIOS 1.2 Wired Network 1.3 Wi‑Fi 2. Partitioning (lsblk and cfdisk) 3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs) 3.1 Format 3.2 Mount 4. Download Stage3, Mount System Directories & chroot 4.1 Stage3 Choice 4.2 Download & Extract 4.3 Mount System Directories 4.4 Enter chroot 5. Portage & Mirrors (with full make.conf example) 5.1 Sync Portage 5.2 Choose Mirrors 5.3 /etc/portage/make.conf Example 6. USE flags & Licenses (Beginner Solutions) 6.1 Check USE 6.2 Add USE safely 6.3 Add License 6.4 Keywords (optional newer versions) 7. Profile Selection (Desktop / Server) 8. Localization (Language & Timezone) 9. Kernel Selection & Compilation (Full Commands) 10. Generate fstab (ext4 / Btrfs examples) 11. Install Bootloader GRUB (with os-prober) 12. Enable Networking (OpenRC / systemd) 13. Wayland / X11 Choice & USE 14. GPU Drivers & CPU Microcode 15. Desktop Environments (Optional) 16. Users & sudo 17. SSH (Optional) 18. Reboot 💻 My Hardware (Example) CPU: AMD Ryzen 9 7950X3D (16C/32T) Motherboard: ASUS ROG STRIX X670E-A GAMING WIFI RAM: 64GB DDR5 GPU: NVIDIA RTX 4080 SUPER + AMD iGPU Storage: NVMe SSD Dual boot: Windows 11 + Gentoo Example only. Steps apply to most x86_64 hardware."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-09-01T00:00:00+00:00"><meta property="article:tag" content="Gentoo"><meta property="article:tag" content="Linux"><meta property="article:tag" content="OpenRC"><meta property="article:tag" content="Systemd"><meta property="article:tag" content="KDE"><meta property="article:tag" content="GNOME"><meta name=twitter:card content="summary"><meta name=twitter:title content="Gentoo Installation Guide (Beginner)"><meta name=twitter:description content="
  
  
    💻 My Hardware (Example)
    0. Download & Create Installation Media
      
        0.1 Download ISO (example: NCHC Taiwan)
        0.2 Create USB Install Disk
      
    
    1. Boot & Network
      
        1.1 Check UEFI / BIOS
        1.2 Wired Network
        1.3 Wi‑Fi
      
    
    2. Partitioning (lsblk and cfdisk)
    3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs)
      
        3.1 Format
        3.2 Mount
      
    
    4. Download Stage3, Mount System Directories & chroot
      
        4.1 Stage3 Choice
        4.2 Download & Extract
        4.3 Mount System Directories
        4.4 Enter chroot
      
    
    5. Portage & Mirrors (with full make.conf example)
      
        5.1 Sync Portage
        5.2 Choose Mirrors
        5.3 /etc/portage/make.conf Example
      
    
    6. USE flags & Licenses (Beginner Solutions)
      
        6.1 Check USE
        6.2 Add USE safely
        6.3 Add License
        6.4 Keywords (optional newer versions)
      
    
    7. Profile Selection (Desktop / Server)
    8. Localization (Language & Timezone)
    9. Kernel Selection & Compilation (Full Commands)
    10. Generate fstab (ext4 / Btrfs examples)
    11. Install Bootloader GRUB (with os-prober)
    12. Enable Networking (OpenRC / systemd)
    13. Wayland / X11 Choice & USE
    14. GPU Drivers & CPU Microcode
    15. Desktop Environments (Optional)
    16. Users & sudo
    17. SSH (Optional)
    18. Reboot
  


💻 My Hardware (Example)

CPU: AMD Ryzen 9 7950X3D (16C/32T)
Motherboard: ASUS ROG STRIX X670E-A GAMING WIFI
RAM: 64GB DDR5
GPU: NVIDIA RTX 4080 SUPER + AMD iGPU
Storage: NVMe SSD
Dual boot: Windows 11 + Gentoo


Example only. Steps apply to most x86_64 hardware."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zakk.au/posts/"},{"@type":"ListItem","position":2,"name":"Gentoo Installation Guide (Beginner)","item":"https://zakk.au/posts/gentoo-install/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Gentoo Installation Guide (Beginner)","name":"Gentoo Installation Guide (Beginner)","description":" 💻 My Hardware (Example) 0. Download \u0026amp; Create Installation Media 0.1 Download ISO (example: NCHC Taiwan) 0.2 Create USB Install Disk 1. Boot \u0026amp; Network 1.1 Check UEFI / BIOS 1.2 Wired Network 1.3 Wi‑Fi 2. Partitioning (lsblk and cfdisk) 3. Filesystem Formatting \u0026amp; Mounting (ext4 / XFS / Btrfs) 3.1 Format 3.2 Mount 4. Download Stage3, Mount System Directories \u0026amp; chroot 4.1 Stage3 Choice 4.2 Download \u0026amp; Extract 4.3 Mount System Directories 4.4 Enter chroot 5. Portage \u0026amp; Mirrors (with full make.conf example) 5.1 Sync Portage 5.2 Choose Mirrors 5.3 /etc/portage/make.conf Example 6. USE flags \u0026amp; Licenses (Beginner Solutions) 6.1 Check USE 6.2 Add USE safely 6.3 Add License 6.4 Keywords (optional newer versions) 7. Profile Selection (Desktop / Server) 8. Localization (Language \u0026amp; Timezone) 9. Kernel Selection \u0026amp; Compilation (Full Commands) 10. Generate fstab (ext4 / Btrfs examples) 11. Install Bootloader GRUB (with os-prober) 12. Enable Networking (OpenRC / systemd) 13. Wayland / X11 Choice \u0026amp; USE 14. GPU Drivers \u0026amp; CPU Microcode 15. Desktop Environments (Optional) 16. Users \u0026amp; sudo 17. SSH (Optional) 18. Reboot 💻 My Hardware (Example) CPU: AMD Ryzen 9 7950X3D (16C/32T) Motherboard: ASUS ROG STRIX X670E-A GAMING WIFI RAM: 64GB DDR5 GPU: NVIDIA RTX 4080 SUPER + AMD iGPU Storage: NVMe SSD Dual boot: Windows 11 + Gentoo Example only. Steps apply to most x86_64 hardware.\n","keywords":["Gentoo","Linux","OpenRC","systemd","KDE","GNOME","SSH","Wayland","Btrfs","UEFI","NVIDIA","AMD","Intel","iwd","wpa_supplicant"],"articleBody":" 💻 My Hardware (Example) 0. Download \u0026 Create Installation Media 0.1 Download ISO (example: NCHC Taiwan) 0.2 Create USB Install Disk 1. Boot \u0026 Network 1.1 Check UEFI / BIOS 1.2 Wired Network 1.3 Wi‑Fi 2. Partitioning (lsblk and cfdisk) 3. Filesystem Formatting \u0026 Mounting (ext4 / XFS / Btrfs) 3.1 Format 3.2 Mount 4. Download Stage3, Mount System Directories \u0026 chroot 4.1 Stage3 Choice 4.2 Download \u0026 Extract 4.3 Mount System Directories 4.4 Enter chroot 5. Portage \u0026 Mirrors (with full make.conf example) 5.1 Sync Portage 5.2 Choose Mirrors 5.3 /etc/portage/make.conf Example 6. USE flags \u0026 Licenses (Beginner Solutions) 6.1 Check USE 6.2 Add USE safely 6.3 Add License 6.4 Keywords (optional newer versions) 7. Profile Selection (Desktop / Server) 8. Localization (Language \u0026 Timezone) 9. Kernel Selection \u0026 Compilation (Full Commands) 10. Generate fstab (ext4 / Btrfs examples) 11. Install Bootloader GRUB (with os-prober) 12. Enable Networking (OpenRC / systemd) 13. Wayland / X11 Choice \u0026 USE 14. GPU Drivers \u0026 CPU Microcode 15. Desktop Environments (Optional) 16. Users \u0026 sudo 17. SSH (Optional) 18. Reboot 💻 My Hardware (Example) CPU: AMD Ryzen 9 7950X3D (16C/32T) Motherboard: ASUS ROG STRIX X670E-A GAMING WIFI RAM: 64GB DDR5 GPU: NVIDIA RTX 4080 SUPER + AMD iGPU Storage: NVMe SSD Dual boot: Windows 11 + Gentoo Example only. Steps apply to most x86_64 hardware.\n0. Download \u0026 Create Installation Media Official mirror list: https://www.gentoo.org/downloads/mirrors/\nUse a mirror close to your region (e.g., Taiwan NCHC, AARNET Australia, Kernel.org global). 0.1 Download ISO (example: NCHC Taiwan) wget https://free.nchc.org.tw/gentoo/releases/amd64/autobuilds/current-install-amd64-minimal/install-amd64-minimal.iso 0.2 Create USB Install Disk Linux (dd):\nsudo dd if=install-amd64-minimal.iso of=/dev/sdX bs=4M status=progress oflag=sync Replace sdX with your USB device.\nWindows (Rufus): https://rufus.ie/\nSelect USB \u0026 ISO Choose dd mode Start 1. Boot \u0026 Network 1.1 Check UEFI / BIOS ls /sys/firmware/efi Exists → UEFI; else → Legacy BIOS.\n1.2 Wired Network ip a dhcpcd eno1 ping -c 3 gentoo.org 1.3 Wi‑Fi wpa_supplicant:\niw dev wpa_passphrase \"SSID\" \"PASSWORD\" | tee /etc/wpa_supplicant/wpa_supplicant.conf wpa_supplicant -B -i wlp9s0 -c /etc/wpa_supplicant/wpa_supplicant.conf dhcpcd wlp9s0 ping -c 3 gentoo.org iwd (recommended):\nemerge net-wireless/iwd systemctl enable iwd systemctl start iwd iwctl [iwd]# device list [iwd]# station wlp9s0 scan [iwd]# station wlp9s0 get-networks [iwd]# station wlp9s0 connect SSID 2. Partitioning (lsblk and cfdisk) Check disks:\nlsblk -o NAME,SIZE,TYPE,MOUNTPOINT Example output:\nnvme0n1 476G disk ├─nvme0n1p1 512M part ├─nvme0n1p2 1G part ├─nvme0n1p3 100G part └─nvme0n1p4 375G part Optional editor:\ncfdisk /dev/nvme0n1 Suggested layout (UEFI):\nSize FS Mount Purpose 512M FAT32 /efi UEFI ESP 1G ext4 /boot kernel, initramfs 100G+ ext4/XFS/Btrfs / root Rest ext4/XFS/Btrfs /home user data 3. Filesystem Formatting \u0026 Mounting (ext4 / XFS / Btrfs) 3.1 Format ext4:\nmkfs.ext4 -L root /dev/nvme0n1p3 mkfs.ext4 -L home /dev/nvme0n1p4 XFS:\nmkfs.xfs -L root /dev/nvme0n1p3 mkfs.xfs -L home /dev/nvme0n1p4 Btrfs (force overwrite with -f if needed):\nmkfs.btrfs -L rootfs /dev/nvme0n1p3 mkfs.btrfs -L home /dev/nvme0n1p4 # Force: mkfs.btrfs -f -L rootfs /dev/nvme0n1p3 3.2 Mount ext4 / XFS:\nmount /dev/nvme0n1p3 /mnt/gentoo mkdir -p /mnt/gentoo/{boot,home,efi} mount /dev/nvme0n1p4 /mnt/gentoo/home mount /dev/nvme0n1p2 /mnt/gentoo/boot mount /dev/nvme0n1p1 /mnt/gentoo/efi Btrfs with subvolumes:\nmount /dev/nvme0n1p3 /mnt/gentoo btrfs subvolume create /mnt/gentoo/@ btrfs subvolume create /mnt/gentoo/@home umount /mnt/gentoo mount -o compress=zstd,subvol=@ /dev/nvme0n1p3 /mnt/gentoo mkdir -p /mnt/gentoo/{boot,home,efi} mount -o subvol=@home /dev/nvme0n1p3 /mnt/gentoo/home mount /dev/nvme0n1p2 /mnt/gentoo/boot mount /dev/nvme0n1p1 /mnt/gentoo/efi 4. Download Stage3, Mount System Directories \u0026 chroot 4.1 Stage3 Choice Use standard Stage3 (glibc), with OpenRC or systemd. “desktop” builds exist but are optional; prefer standard + correct profile. 4.2 Download \u0026 Extract cd /mnt/gentoo links https://www.gentoo.org/downloads/mirrors/ tar xpvf stage3-*.tar.xz --xattrs-include='*.*' --numeric-owner 4.3 Mount System Directories OpenRC:\nmount -t proc /proc /mnt/gentoo/proc mount --rbind /sys /mnt/gentoo/sys mount --rbind /dev /mnt/gentoo/dev systemd:\nmount -t proc /proc /mnt/gentoo/proc mount --rbind /sys /mnt/gentoo/sys \u0026\u0026 mount --make-rslave /mnt/gentoo/sys mount --rbind /dev /mnt/gentoo/dev \u0026\u0026 mount --make-rslave /mnt/gentoo/dev mount --rbind /run /mnt/gentoo/run \u0026\u0026 mount --make-rslave /mnt/gentoo/run 4.4 Enter chroot chroot /mnt/gentoo /bin/bash source /etc/profile export PS1=\"(chroot) $PS1\" 5. Portage \u0026 Mirrors (with full make.conf example) 5.1 Sync Portage emerge-webrsync emerge --sync 5.2 Choose Mirrors Interactive:\nemerge --ask app-portage/mirrorselect mirrorselect -i -o \u003e\u003e /etc/portage/make.conf Manual (keep only one):\necho 'GENTOO_MIRRORS=\"https://free.nchc.org.tw/gentoo/\"' \u003e\u003e /etc/portage/make.conf 5.3 /etc/portage/make.conf Example COMMON_FLAGS=\"-march=native -O2 -pipe\" MAKEOPTS=\"-j32\" EMERGE_DEFAULT_OPTS=\"--ask --verbose --with-bdeps=y --complete-graph=y\" GENTOO_MIRRORS=\"https://free.nchc.org.tw/gentoo/\" USE=\"wayland egl pipewire vulkan\" # USE=\"X xwayland egl pipewire vulkan\" VIDEO_CARDS=\"nvidia\" # VIDEO_CARDS=\"amdgpu radeonsi\" # VIDEO_CARDS=\"intel i965 iris\" # VIDEO_CARDS=\"nouveau\" ACCEPT_LICENSE=\"*\" 6. USE flags \u0026 Licenses (Beginner Solutions) 6.1 Check USE emerge -pv firefox 6.2 Add USE safely echo \"media-video/ffmpeg X wayland\" \u003e\u003e /etc/portage/package.use/ffmpeg 6.3 Add License echo \"www-client/google-chrome google-chrome\" \u003e\u003e /etc/portage/package.license 6.4 Keywords (optional newer versions) echo \"www-client/google-chrome ~amd64\" \u003e\u003e /etc/portage/package.accept_keywords 7. Profile Selection (Desktop / Server) eselect profile list Examples:\nKDE + systemd → default/linux/amd64/23.0/desktop/plasma/systemd GNOME + systemd → default/linux/amd64/23.0/desktop/gnome/systemd Desktop + OpenRC → default/linux/amd64/23.0/desktop Server → default/linux/amd64/23.0 Apply \u0026 update:\neselect profile set emerge -avuDN @world 8. Localization (Language \u0026 Timezone) Locales:\nen_US.UTF-8 UTF-8 en_AU.UTF-8 UTF-8 locale-gen eselect locale set en_US.utf8 Timezone:\nls /usr/share/zoneinfo echo \"Australia/Melbourne\" \u003e /etc/timezone emerge --config sys-libs/timezone-data List of timezones\n9. Kernel Selection \u0026 Compilation (Full Commands) Prebuilt (recommended):\nemerge sys-kernel/gentoo-kernel-bin Manual compile:\nemerge sys-kernel/gentoo-sources cd /usr/src/linux make menuconfig make -j\"$(nproc)\" make modules_install make install Initramfs (if using Btrfs, LUKS, RAID, modular drivers):\nDracut: emerge sys-kernel/dracut dracut --kver \"$(ls /lib/modules | sort -V | tail -1)\" Genkernel: emerge sys-kernel/genkernel genkernel initramfs 10. Generate fstab (ext4 / Btrfs examples) blkid lsblk -f ext4:\nUUID= /efi vfat noatime,umask=0077 0 2 UUID= /boot ext4 noatime 0 2 UUID= / ext4 noatime 0 1 UUID= /home ext4 noatime 0 2 Btrfs:\nUUID= /efi vfat noatime,umask=0077 0 2 UUID= / btrfs noatime,compress=zstd,subvol=@ 0 1 UUID= /home btrfs noatime,compress=zstd,subvol=@home 0 2 11. Install Bootloader GRUB (with os-prober) emerge grub efibootmgr grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=Gentoo emerge --ask sys-boot/os-prober echo 'GRUB_DISABLE_OS_PROBER=false' \u003e\u003e /etc/default/grub grub-mkconfig -o /boot/grub/grub.cfg If root uses Btrfs:\nemerge --ask sys-fs/btrfs-progs 12. Enable Networking (OpenRC / systemd) systemd:\nemerge net-misc/networkmanager systemctl enable NetworkManager OpenRC:\nemerge net-misc/dhcpcd rc-update add dhcpcd default 13. Wayland / X11 Choice \u0026 USE Wayland:\nUSE=\"wayland egl pipewire vulkan\" X11:\nUSE=\"X xwayland egl pipewire vulkan\" 14. GPU Drivers \u0026 CPU Microcode NVIDIA Proprietary:\nVIDEO_CARDS=\"nvidia\" emerge x11-drivers/nvidia-drivers Nouveau (open source):\nVIDEO_CARDS=\"nouveau\" emerge x11-base/xorg-drivers AMD:\nVIDEO_CARDS=\"amdgpu radeonsi\" emerge mesa vulkan-loader Intel:\nVIDEO_CARDS=\"intel i965 iris\" emerge mesa vulkan-loader CPU microcode:\nemerge sys-firmware/intel-microcode emerge sys-firmware/amd-ucode 15. Desktop Environments (Optional) KDE Plasma:\nemerge kde-plasma/plasma-meta x11-misc/sddm x11-base/xwayland systemctl enable sddm GNOME:\nemerge gnome-base/gnome gnome-base/gdm systemctl enable gdm 16. Users \u0026 sudo passwd useradd -m -G wheel,audio,video,usb -s /bin/bash zakk passwd zakk emerge app-admin/sudo echo \"%wheel ALL=(ALL) ALL\" \u003e\u003e /etc/sudoers ⚠️ Replace zakk with your own username.\n17. SSH (Optional) emerge net-misc/openssh systemctl enable sshd \u0026\u0026 systemctl start sshd 18. Reboot exit umount -R /mnt/gentoo reboot 💡 FAQ Slow downloads → choose nearest mirror. Wi‑Fi WPA3 unstable → try WPA2. Wayland vs X11 → AMD/Intel: Wayland; Compatibility: X11. NVIDIA → new cards proprietary driver; old cards → nouveau. USE conflicts → check emerge -pv and add to package.use. License blocks → add to package.license. Need newer versions → use package.accept_keywords. Btrfs + LUKS/RAID → initramfs recommended. 📎 References Gentoo Handbook: https://wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation Bitbili: https://bitbili.net/gentoo-linux-installation-and-usage-tutorial.html Rufus: https://rufus.ie/ Timezones: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones ","wordCount":"1152","inLanguage":"en","datePublished":"2025-09-01T00:00:00Z","dateModified":"2025-09-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://zakk.au/posts/gentoo-install/"},"publisher":{"@type":"Organization","name":"Zakk's Blog","logo":{"@type":"ImageObject","url":"https://zakk.au/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zakk.au/ accesskey=h title="Zakk's Blog (Alt + H)">Zakk's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://zakk.au/zh-hant/ title=漢語 aria-label=漢語>Zh-Hant</a></li></ul></div></div><ul id=menu><li><a href=https://zakk.au/ title=Home><span>Home</span></a></li><li><a href=https://zakk.au/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://zakk.au/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zakk.au/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zakk.au/>Home</a>&nbsp;»&nbsp;<a href=https://zakk.au/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Gentoo Installation Guide (Beginner)</h1><div class=post-meta><span title='2025-09-01 00:00:00 +0000 UTC'>September 1, 2025</span>&nbsp;·&nbsp;6 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#-my-hardware-example>💻 My Hardware (Example)</a></li><li><a href=#0-download--create-installation-media>0. Download & Create Installation Media</a><ul><li><a href=#01-download-iso-example-nchc-taiwan>0.1 Download ISO (example: NCHC Taiwan)</a></li><li><a href=#02-create-usb-install-disk>0.2 Create USB Install Disk</a></li></ul></li><li><a href=#1-boot--network>1. Boot & Network</a><ul><li><a href=#11-check-uefi--bios>1.1 Check UEFI / BIOS</a></li><li><a href=#12-wired-network>1.2 Wired Network</a></li><li><a href=#13-wifi>1.3 Wi‑Fi</a></li></ul></li><li><a href=#2-partitioning-lsblk-and-cfdisk>2. Partitioning (lsblk and cfdisk)</a></li><li><a href=#3-filesystem-formatting--mounting-ext4--xfs--btrfs>3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs)</a><ul><li><a href=#31-format>3.1 Format</a></li><li><a href=#32-mount>3.2 Mount</a></li></ul></li><li><a href=#4-download-stage3-mount-system-directories--chroot>4. Download Stage3, Mount System Directories & chroot</a><ul><li><a href=#41-stage3-choice>4.1 Stage3 Choice</a></li><li><a href=#42-download--extract>4.2 Download & Extract</a></li><li><a href=#43-mount-system-directories>4.3 Mount System Directories</a></li><li><a href=#44-enter-chroot>4.4 Enter chroot</a></li></ul></li><li><a href=#5-portage--mirrors-with-full-makeconf-example>5. Portage & Mirrors (with full make.conf example)</a><ul><li><a href=#51-sync-portage>5.1 Sync Portage</a></li><li><a href=#52-choose-mirrors>5.2 Choose Mirrors</a></li><li><a href=#53-etcportagemakeconf-example>5.3 <code>/etc/portage/make.conf</code> Example</a></li></ul></li><li><a href=#6-use-flags--licenses-beginner-solutions>6. USE flags & Licenses (Beginner Solutions)</a><ul><li><a href=#61-check-use>6.1 Check USE</a></li><li><a href=#62-add-use-safely>6.2 Add USE safely</a></li><li><a href=#63-add-license>6.3 Add License</a></li><li><a href=#64-keywords-optional-newer-versions>6.4 Keywords (optional newer versions)</a></li></ul></li><li><a href=#7-profile-selection-desktop--server>7. Profile Selection (Desktop / Server)</a></li><li><a href=#8-localization-language--timezone>8. Localization (Language & Timezone)</a></li><li><a href=#9-kernel-selection--compilation-full-commands>9. Kernel Selection & Compilation (Full Commands)</a></li><li><a href=#10-generate-fstab-ext4--btrfs-examples>10. Generate fstab (ext4 / Btrfs examples)</a></li><li><a href=#11-install-bootloader-grub-with-os-prober>11. Install Bootloader GRUB (with os-prober)</a></li><li><a href=#12-enable-networking-openrc--systemd>12. Enable Networking (OpenRC / systemd)</a></li><li><a href=#13-wayland--x11-choice--use>13. Wayland / X11 Choice & USE</a></li><li><a href=#14-gpu-drivers--cpu-microcode>14. GPU Drivers & CPU Microcode</a></li><li><a href=#15-desktop-environments-optional>15. Desktop Environments (Optional)</a></li><li><a href=#16-users--sudo>16. Users & sudo</a></li><li><a href=#17-ssh-optional>17. SSH (Optional)</a></li><li><a href=#18-reboot>18. Reboot</a></li></ul></nav></div></details></div><div class=post-content><div class=toc-embedded><nav id=TableOfContents><ul><li><a href=#-my-hardware-example>💻 My Hardware (Example)</a></li><li><a href=#0-download--create-installation-media>0. Download & Create Installation Media</a><ul><li><a href=#01-download-iso-example-nchc-taiwan>0.1 Download ISO (example: NCHC Taiwan)</a></li><li><a href=#02-create-usb-install-disk>0.2 Create USB Install Disk</a></li></ul></li><li><a href=#1-boot--network>1. Boot & Network</a><ul><li><a href=#11-check-uefi--bios>1.1 Check UEFI / BIOS</a></li><li><a href=#12-wired-network>1.2 Wired Network</a></li><li><a href=#13-wifi>1.3 Wi‑Fi</a></li></ul></li><li><a href=#2-partitioning-lsblk-and-cfdisk>2. Partitioning (lsblk and cfdisk)</a></li><li><a href=#3-filesystem-formatting--mounting-ext4--xfs--btrfs>3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs)</a><ul><li><a href=#31-format>3.1 Format</a></li><li><a href=#32-mount>3.2 Mount</a></li></ul></li><li><a href=#4-download-stage3-mount-system-directories--chroot>4. Download Stage3, Mount System Directories & chroot</a><ul><li><a href=#41-stage3-choice>4.1 Stage3 Choice</a></li><li><a href=#42-download--extract>4.2 Download & Extract</a></li><li><a href=#43-mount-system-directories>4.3 Mount System Directories</a></li><li><a href=#44-enter-chroot>4.4 Enter chroot</a></li></ul></li><li><a href=#5-portage--mirrors-with-full-makeconf-example>5. Portage & Mirrors (with full make.conf example)</a><ul><li><a href=#51-sync-portage>5.1 Sync Portage</a></li><li><a href=#52-choose-mirrors>5.2 Choose Mirrors</a></li><li><a href=#53-etcportagemakeconf-example>5.3 <code>/etc/portage/make.conf</code> Example</a></li></ul></li><li><a href=#6-use-flags--licenses-beginner-solutions>6. USE flags & Licenses (Beginner Solutions)</a><ul><li><a href=#61-check-use>6.1 Check USE</a></li><li><a href=#62-add-use-safely>6.2 Add USE safely</a></li><li><a href=#63-add-license>6.3 Add License</a></li><li><a href=#64-keywords-optional-newer-versions>6.4 Keywords (optional newer versions)</a></li></ul></li><li><a href=#7-profile-selection-desktop--server>7. Profile Selection (Desktop / Server)</a></li><li><a href=#8-localization-language--timezone>8. Localization (Language & Timezone)</a></li><li><a href=#9-kernel-selection--compilation-full-commands>9. Kernel Selection & Compilation (Full Commands)</a></li><li><a href=#10-generate-fstab-ext4--btrfs-examples>10. Generate fstab (ext4 / Btrfs examples)</a></li><li><a href=#11-install-bootloader-grub-with-os-prober>11. Install Bootloader GRUB (with os-prober)</a></li><li><a href=#12-enable-networking-openrc--systemd>12. Enable Networking (OpenRC / systemd)</a></li><li><a href=#13-wayland--x11-choice--use>13. Wayland / X11 Choice & USE</a></li><li><a href=#14-gpu-drivers--cpu-microcode>14. GPU Drivers & CPU Microcode</a></li><li><a href=#15-desktop-environments-optional>15. Desktop Environments (Optional)</a></li><li><a href=#16-users--sudo>16. Users & sudo</a></li><li><a href=#17-ssh-optional>17. SSH (Optional)</a></li><li><a href=#18-reboot>18. Reboot</a></li></ul></nav></div><h2 id=-my-hardware-example>💻 My Hardware (Example)<a hidden class=anchor aria-hidden=true href=#-my-hardware-example>#</a></h2><ul><li><strong>CPU</strong>: AMD Ryzen 9 7950X3D (16C/32T)</li><li><strong>Motherboard</strong>: ASUS ROG STRIX X670E-A GAMING WIFI</li><li><strong>RAM</strong>: 64GB DDR5</li><li><strong>GPU</strong>: NVIDIA RTX 4080 SUPER + AMD iGPU</li><li><strong>Storage</strong>: NVMe SSD</li><li><strong>Dual boot</strong>: Windows 11 + Gentoo</li></ul><blockquote><p>Example only. Steps apply to most x86_64 hardware.</p></blockquote><hr><h2 id=0-download--create-installation-media>0. Download & Create Installation Media<a hidden class=anchor aria-hidden=true href=#0-download--create-installation-media>#</a></h2><p><strong>Official mirror list</strong>: <a href=https://www.gentoo.org/downloads/mirrors/>https://www.gentoo.org/downloads/mirrors/</a></p><ul><li>Use a mirror close to your region (e.g., Taiwan NCHC, AARNET Australia, Kernel.org global).</li></ul><h3 id=01-download-iso-example-nchc-taiwan>0.1 Download ISO (example: NCHC Taiwan)<a hidden class=anchor aria-hidden=true href=#01-download-iso-example-nchc-taiwan>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://free.nchc.org.tw/gentoo/releases/amd64/autobuilds/current-install-amd64-minimal/install-amd64-minimal.iso
</span></span></code></pre></div><h3 id=02-create-usb-install-disk>0.2 Create USB Install Disk<a hidden class=anchor aria-hidden=true href=#02-create-usb-install-disk>#</a></h3><p><strong>Linux (dd)</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span>install-amd64-minimal.iso of<span style=color:#f92672>=</span>/dev/sdX bs<span style=color:#f92672>=</span>4M status<span style=color:#f92672>=</span>progress oflag<span style=color:#f92672>=</span>sync
</span></span></code></pre></div><p>Replace <code>sdX</code> with your USB device.</p><p><strong>Windows (Rufus)</strong>: <a href=https://rufus.ie/>https://rufus.ie/</a></p><ol><li>Select USB & ISO</li><li>Choose <strong>dd mode</strong></li><li>Start</li></ol><hr><h2 id=1-boot--network>1. Boot & Network<a hidden class=anchor aria-hidden=true href=#1-boot--network>#</a></h2><h3 id=11-check-uefi--bios>1.1 Check UEFI / BIOS<a hidden class=anchor aria-hidden=true href=#11-check-uefi--bios>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls /sys/firmware/efi
</span></span></code></pre></div><p>Exists → UEFI; else → Legacy BIOS.</p><h3 id=12-wired-network>1.2 Wired Network<a hidden class=anchor aria-hidden=true href=#12-wired-network>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ip a
</span></span><span style=display:flex><span>dhcpcd eno1
</span></span><span style=display:flex><span>ping -c <span style=color:#ae81ff>3</span> gentoo.org
</span></span></code></pre></div><h3 id=13-wifi>1.3 Wi‑Fi<a hidden class=anchor aria-hidden=true href=#13-wifi>#</a></h3><p><strong>wpa_supplicant</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iw dev
</span></span><span style=display:flex><span>wpa_passphrase <span style=color:#e6db74>&#34;SSID&#34;</span> <span style=color:#e6db74>&#34;PASSWORD&#34;</span> | tee /etc/wpa_supplicant/wpa_supplicant.conf
</span></span><span style=display:flex><span>wpa_supplicant -B -i wlp9s0 -c /etc/wpa_supplicant/wpa_supplicant.conf
</span></span><span style=display:flex><span>dhcpcd wlp9s0
</span></span><span style=display:flex><span>ping -c <span style=color:#ae81ff>3</span> gentoo.org
</span></span></code></pre></div><p><strong>iwd (recommended)</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge net-wireless/iwd
</span></span><span style=display:flex><span>systemctl enable iwd
</span></span><span style=display:flex><span>systemctl start iwd
</span></span><span style=display:flex><span>iwctl
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>iwd<span style=color:#f92672>]</span><span style=color:#75715e># device list</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>iwd<span style=color:#f92672>]</span><span style=color:#75715e># station wlp9s0 scan</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>iwd<span style=color:#f92672>]</span><span style=color:#75715e># station wlp9s0 get-networks</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>iwd<span style=color:#f92672>]</span><span style=color:#75715e># station wlp9s0 connect SSID</span>
</span></span></code></pre></div><hr><h2 id=2-partitioning-lsblk-and-cfdisk>2. Partitioning (lsblk and cfdisk)<a hidden class=anchor aria-hidden=true href=#2-partitioning-lsblk-and-cfdisk>#</a></h2><p>Check disks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>lsblk -o NAME,SIZE,TYPE,MOUNTPOINT
</span></span></code></pre></div><p>Example output:</p><pre tabindex=0><code>nvme0n1    476G disk
├─nvme0n1p1 512M part
├─nvme0n1p2   1G part
├─nvme0n1p3 100G part
└─nvme0n1p4 375G part
</code></pre><p>Optional editor:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cfdisk /dev/nvme0n1
</span></span></code></pre></div><p><strong>Suggested layout (UEFI)</strong>:</p><table><thead><tr><th>Size</th><th>FS</th><th>Mount</th><th>Purpose</th></tr></thead><tbody><tr><td>512M</td><td>FAT32</td><td>/efi</td><td>UEFI ESP</td></tr><tr><td>1G</td><td>ext4</td><td>/boot</td><td>kernel, initramfs</td></tr><tr><td>100G+</td><td>ext4/XFS/Btrfs</td><td>/</td><td>root</td></tr><tr><td>Rest</td><td>ext4/XFS/Btrfs</td><td>/home</td><td>user data</td></tr></tbody></table><hr><h2 id=3-filesystem-formatting--mounting-ext4--xfs--btrfs>3. Filesystem Formatting & Mounting (ext4 / XFS / Btrfs)<a hidden class=anchor aria-hidden=true href=#3-filesystem-formatting--mounting-ext4--xfs--btrfs>#</a></h2><h3 id=31-format>3.1 Format<a hidden class=anchor aria-hidden=true href=#31-format>#</a></h3><p><strong>ext4</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.ext4 -L root /dev/nvme0n1p3
</span></span><span style=display:flex><span>mkfs.ext4 -L home /dev/nvme0n1p4
</span></span></code></pre></div><p><strong>XFS</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.xfs -L root /dev/nvme0n1p3
</span></span><span style=display:flex><span>mkfs.xfs -L home /dev/nvme0n1p4
</span></span></code></pre></div><p><strong>Btrfs</strong> (force overwrite with <code>-f</code> if needed):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.btrfs -L rootfs /dev/nvme0n1p3
</span></span><span style=display:flex><span>mkfs.btrfs -L home   /dev/nvme0n1p4
</span></span><span style=display:flex><span><span style=color:#75715e># Force: mkfs.btrfs -f -L rootfs /dev/nvme0n1p3</span>
</span></span></code></pre></div><h3 id=32-mount>3.2 Mount<a hidden class=anchor aria-hidden=true href=#32-mount>#</a></h3><p><strong>ext4 / XFS</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mount /dev/nvme0n1p3 /mnt/gentoo
</span></span><span style=display:flex><span>mkdir -p /mnt/gentoo/<span style=color:#f92672>{</span>boot,home,efi<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>mount /dev/nvme0n1p4 /mnt/gentoo/home
</span></span><span style=display:flex><span>mount /dev/nvme0n1p2 /mnt/gentoo/boot
</span></span><span style=display:flex><span>mount /dev/nvme0n1p1 /mnt/gentoo/efi
</span></span></code></pre></div><p><strong>Btrfs with subvolumes</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mount /dev/nvme0n1p3 /mnt/gentoo
</span></span><span style=display:flex><span>btrfs subvolume create /mnt/gentoo/@
</span></span><span style=display:flex><span>btrfs subvolume create /mnt/gentoo/@home
</span></span><span style=display:flex><span>umount /mnt/gentoo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mount -o compress<span style=color:#f92672>=</span>zstd,subvol<span style=color:#f92672>=</span>@    /dev/nvme0n1p3 /mnt/gentoo
</span></span><span style=display:flex><span>mkdir -p /mnt/gentoo/<span style=color:#f92672>{</span>boot,home,efi<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>mount -o subvol<span style=color:#f92672>=</span>@home              /dev/nvme0n1p3 /mnt/gentoo/home
</span></span><span style=display:flex><span>mount /dev/nvme0n1p2 /mnt/gentoo/boot
</span></span><span style=display:flex><span>mount /dev/nvme0n1p1 /mnt/gentoo/efi
</span></span></code></pre></div><hr><h2 id=4-download-stage3-mount-system-directories--chroot>4. Download Stage3, Mount System Directories & chroot<a hidden class=anchor aria-hidden=true href=#4-download-stage3-mount-system-directories--chroot>#</a></h2><h3 id=41-stage3-choice>4.1 Stage3 Choice<a hidden class=anchor aria-hidden=true href=#41-stage3-choice>#</a></h3><ul><li>Use <strong>standard Stage3 (glibc)</strong>, with OpenRC or systemd.</li><li>“desktop” builds exist but are optional; prefer standard + correct profile.</li></ul><h3 id=42-download--extract>4.2 Download & Extract<a hidden class=anchor aria-hidden=true href=#42-download--extract>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /mnt/gentoo
</span></span><span style=display:flex><span>links https://www.gentoo.org/downloads/mirrors/
</span></span><span style=display:flex><span>tar xpvf stage3-*.tar.xz --xattrs-include<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;*.*&#39;</span> --numeric-owner
</span></span></code></pre></div><h3 id=43-mount-system-directories>4.3 Mount System Directories<a hidden class=anchor aria-hidden=true href=#43-mount-system-directories>#</a></h3><p><strong>OpenRC</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mount -t proc /proc /mnt/gentoo/proc
</span></span><span style=display:flex><span>mount --rbind /sys /mnt/gentoo/sys
</span></span><span style=display:flex><span>mount --rbind /dev /mnt/gentoo/dev
</span></span></code></pre></div><p><strong>systemd</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mount -t proc /proc /mnt/gentoo/proc
</span></span><span style=display:flex><span>mount --rbind /sys /mnt/gentoo/sys <span style=color:#f92672>&amp;&amp;</span> mount --make-rslave /mnt/gentoo/sys
</span></span><span style=display:flex><span>mount --rbind /dev /mnt/gentoo/dev <span style=color:#f92672>&amp;&amp;</span> mount --make-rslave /mnt/gentoo/dev
</span></span><span style=display:flex><span>mount --rbind /run /mnt/gentoo/run <span style=color:#f92672>&amp;&amp;</span> mount --make-rslave /mnt/gentoo/run
</span></span></code></pre></div><h3 id=44-enter-chroot>4.4 Enter chroot<a hidden class=anchor aria-hidden=true href=#44-enter-chroot>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chroot /mnt/gentoo /bin/bash
</span></span><span style=display:flex><span>source /etc/profile
</span></span><span style=display:flex><span>export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;(chroot) </span>$PS1<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><hr><h2 id=5-portage--mirrors-with-full-makeconf-example>5. Portage & Mirrors (with full make.conf example)<a hidden class=anchor aria-hidden=true href=#5-portage--mirrors-with-full-makeconf-example>#</a></h2><h3 id=51-sync-portage>5.1 Sync Portage<a hidden class=anchor aria-hidden=true href=#51-sync-portage>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge-webrsync
</span></span><span style=display:flex><span>emerge --sync
</span></span></code></pre></div><h3 id=52-choose-mirrors>5.2 Choose Mirrors<a hidden class=anchor aria-hidden=true href=#52-choose-mirrors>#</a></h3><p>Interactive:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge --ask app-portage/mirrorselect
</span></span><span style=display:flex><span>mirrorselect -i -o &gt;&gt; /etc/portage/make.conf
</span></span></code></pre></div><p>Manual (keep only one):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#39;GENTOO_MIRRORS=&#34;https://free.nchc.org.tw/gentoo/&#34;&#39;</span> &gt;&gt; /etc/portage/make.conf
</span></span></code></pre></div><h3 id=53-etcportagemakeconf-example>5.3 <code>/etc/portage/make.conf</code> Example<a hidden class=anchor aria-hidden=true href=#53-etcportagemakeconf-example>#</a></h3><pre tabindex=0><code class=language-conf data-lang=conf>COMMON_FLAGS=&#34;-march=native -O2 -pipe&#34;
MAKEOPTS=&#34;-j32&#34;
EMERGE_DEFAULT_OPTS=&#34;--ask --verbose --with-bdeps=y --complete-graph=y&#34;
GENTOO_MIRRORS=&#34;https://free.nchc.org.tw/gentoo/&#34;
USE=&#34;wayland egl pipewire vulkan&#34;
# USE=&#34;X xwayland egl pipewire vulkan&#34;
VIDEO_CARDS=&#34;nvidia&#34;
# VIDEO_CARDS=&#34;amdgpu radeonsi&#34;
# VIDEO_CARDS=&#34;intel i965 iris&#34;
# VIDEO_CARDS=&#34;nouveau&#34;
ACCEPT_LICENSE=&#34;*&#34;
</code></pre><hr><h2 id=6-use-flags--licenses-beginner-solutions>6. USE flags & Licenses (Beginner Solutions)<a hidden class=anchor aria-hidden=true href=#6-use-flags--licenses-beginner-solutions>#</a></h2><h3 id=61-check-use>6.1 Check USE<a hidden class=anchor aria-hidden=true href=#61-check-use>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge -pv firefox
</span></span></code></pre></div><h3 id=62-add-use-safely>6.2 Add USE safely<a hidden class=anchor aria-hidden=true href=#62-add-use-safely>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;media-video/ffmpeg X wayland&#34;</span> &gt;&gt; /etc/portage/package.use/ffmpeg
</span></span></code></pre></div><h3 id=63-add-license>6.3 Add License<a hidden class=anchor aria-hidden=true href=#63-add-license>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;www-client/google-chrome google-chrome&#34;</span> &gt;&gt; /etc/portage/package.license
</span></span></code></pre></div><h3 id=64-keywords-optional-newer-versions>6.4 Keywords (optional newer versions)<a hidden class=anchor aria-hidden=true href=#64-keywords-optional-newer-versions>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;www-client/google-chrome ~amd64&#34;</span> &gt;&gt; /etc/portage/package.accept_keywords
</span></span></code></pre></div><hr><h2 id=7-profile-selection-desktop--server>7. Profile Selection (Desktop / Server)<a hidden class=anchor aria-hidden=true href=#7-profile-selection-desktop--server>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eselect profile list
</span></span></code></pre></div><p>Examples:</p><ul><li>KDE + systemd → <code>default/linux/amd64/23.0/desktop/plasma/systemd</code></li><li>GNOME + systemd → <code>default/linux/amd64/23.0/desktop/gnome/systemd</code></li><li>Desktop + OpenRC → <code>default/linux/amd64/23.0/desktop</code></li><li>Server → <code>default/linux/amd64/23.0</code></li></ul><p>Apply & update:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eselect profile set &lt;id&gt;
</span></span><span style=display:flex><span>emerge -avuDN @world
</span></span></code></pre></div><hr><h2 id=8-localization-language--timezone>8. Localization (Language & Timezone)<a hidden class=anchor aria-hidden=true href=#8-localization-language--timezone>#</a></h2><p><strong>Locales</strong>:</p><pre tabindex=0><code class=language-conf data-lang=conf>en_US.UTF-8 UTF-8
en_AU.UTF-8 UTF-8
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>locale-gen
</span></span><span style=display:flex><span>eselect locale set en_US.utf8
</span></span></code></pre></div><p><strong>Timezone</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls /usr/share/zoneinfo
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Australia/Melbourne&#34;</span> &gt; /etc/timezone
</span></span><span style=display:flex><span>emerge --config sys-libs/timezone-data
</span></span></code></pre></div><p><a href=https://en.wikipedia.org/wiki/List_of_tz_database_time_zones>List of timezones</a></p><hr><h2 id=9-kernel-selection--compilation-full-commands>9. Kernel Selection & Compilation (Full Commands)<a hidden class=anchor aria-hidden=true href=#9-kernel-selection--compilation-full-commands>#</a></h2><p><strong>Prebuilt (recommended)</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge sys-kernel/gentoo-kernel-bin
</span></span></code></pre></div><p><strong>Manual compile</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge sys-kernel/gentoo-sources
</span></span><span style=display:flex><span>cd /usr/src/linux
</span></span><span style=display:flex><span>make menuconfig
</span></span><span style=display:flex><span>make -j<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>nproc<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>make modules_install
</span></span><span style=display:flex><span>make install
</span></span></code></pre></div><p><strong>Initramfs (if using Btrfs, LUKS, RAID, modular drivers)</strong>:</p><ul><li>Dracut:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge sys-kernel/dracut
</span></span><span style=display:flex><span>dracut --kver <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>ls /lib/modules | sort -V | tail -1<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><ul><li>Genkernel:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge sys-kernel/genkernel
</span></span><span style=display:flex><span>genkernel initramfs
</span></span></code></pre></div><hr><h2 id=10-generate-fstab-ext4--btrfs-examples>10. Generate fstab (ext4 / Btrfs examples)<a hidden class=anchor aria-hidden=true href=#10-generate-fstab-ext4--btrfs-examples>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>blkid
</span></span><span style=display:flex><span>lsblk -f
</span></span></code></pre></div><p><strong>ext4</strong>:</p><pre tabindex=0><code class=language-fstab data-lang=fstab>UUID=&lt;UUID-ESP&gt;  /efi   vfat  noatime,umask=0077 0 2
UUID=&lt;UUID-BOOT&gt; /boot  ext4  noatime            0 2
UUID=&lt;UUID-ROOT&gt; /      ext4  noatime            0 1
UUID=&lt;UUID-HOME&gt; /home  ext4  noatime            0 2
</code></pre><p><strong>Btrfs</strong>:</p><pre tabindex=0><code class=language-fstab data-lang=fstab>UUID=&lt;UUID-ESP&gt;  /efi   vfat   noatime,umask=0077 0 2
UUID=&lt;UUID-ROOT&gt; /      btrfs  noatime,compress=zstd,subvol=@     0 1
UUID=&lt;UUID-ROOT&gt; /home  btrfs  noatime,compress=zstd,subvol=@home 0 2
</code></pre><hr><h2 id=11-install-bootloader-grub-with-os-prober>11. Install Bootloader GRUB (with os-prober)<a hidden class=anchor aria-hidden=true href=#11-install-bootloader-grub-with-os-prober>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge grub efibootmgr
</span></span><span style=display:flex><span>grub-install --target<span style=color:#f92672>=</span>x86_64-efi --efi-directory<span style=color:#f92672>=</span>/efi --bootloader-id<span style=color:#f92672>=</span>Gentoo
</span></span><span style=display:flex><span>emerge --ask sys-boot/os-prober
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;GRUB_DISABLE_OS_PROBER=false&#39;</span> &gt;&gt; /etc/default/grub
</span></span><span style=display:flex><span>grub-mkconfig -o /boot/grub/grub.cfg
</span></span></code></pre></div><p>If root uses Btrfs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge --ask sys-fs/btrfs-progs
</span></span></code></pre></div><hr><h2 id=12-enable-networking-openrc--systemd>12. Enable Networking (OpenRC / systemd)<a hidden class=anchor aria-hidden=true href=#12-enable-networking-openrc--systemd>#</a></h2><p><strong>systemd</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge net-misc/networkmanager
</span></span><span style=display:flex><span>systemctl enable NetworkManager
</span></span></code></pre></div><p><strong>OpenRC</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge net-misc/dhcpcd
</span></span><span style=display:flex><span>rc-update add dhcpcd default
</span></span></code></pre></div><hr><h2 id=13-wayland--x11-choice--use>13. Wayland / X11 Choice & USE<a hidden class=anchor aria-hidden=true href=#13-wayland--x11-choice--use>#</a></h2><p>Wayland:</p><pre tabindex=0><code class=language-conf data-lang=conf>USE=&#34;wayland egl pipewire vulkan&#34;
</code></pre><p>X11:</p><pre tabindex=0><code class=language-conf data-lang=conf>USE=&#34;X xwayland egl pipewire vulkan&#34;
</code></pre><hr><h2 id=14-gpu-drivers--cpu-microcode>14. GPU Drivers & CPU Microcode<a hidden class=anchor aria-hidden=true href=#14-gpu-drivers--cpu-microcode>#</a></h2><p><strong>NVIDIA Proprietary</strong>:</p><pre tabindex=0><code class=language-conf data-lang=conf>VIDEO_CARDS=&#34;nvidia&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge x11-drivers/nvidia-drivers
</span></span></code></pre></div><p><strong>Nouveau (open source)</strong>:</p><pre tabindex=0><code class=language-conf data-lang=conf>VIDEO_CARDS=&#34;nouveau&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge x11-base/xorg-drivers
</span></span></code></pre></div><p><strong>AMD</strong>:</p><pre tabindex=0><code class=language-conf data-lang=conf>VIDEO_CARDS=&#34;amdgpu radeonsi&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge mesa vulkan-loader
</span></span></code></pre></div><p><strong>Intel</strong>:</p><pre tabindex=0><code class=language-conf data-lang=conf>VIDEO_CARDS=&#34;intel i965 iris&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge mesa vulkan-loader
</span></span></code></pre></div><p><strong>CPU microcode</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge sys-firmware/intel-microcode
</span></span><span style=display:flex><span>emerge sys-firmware/amd-ucode
</span></span></code></pre></div><hr><h2 id=15-desktop-environments-optional>15. Desktop Environments (Optional)<a hidden class=anchor aria-hidden=true href=#15-desktop-environments-optional>#</a></h2><p><strong>KDE Plasma</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge kde-plasma/plasma-meta x11-misc/sddm x11-base/xwayland
</span></span><span style=display:flex><span>systemctl enable sddm
</span></span></code></pre></div><p><strong>GNOME</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge gnome-base/gnome gnome-base/gdm
</span></span><span style=display:flex><span>systemctl enable gdm
</span></span></code></pre></div><hr><h2 id=16-users--sudo>16. Users & sudo<a hidden class=anchor aria-hidden=true href=#16-users--sudo>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>passwd
</span></span><span style=display:flex><span>useradd -m -G wheel,audio,video,usb -s /bin/bash zakk
</span></span><span style=display:flex><span>passwd zakk
</span></span><span style=display:flex><span>emerge app-admin/sudo
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;%wheel ALL=(ALL) ALL&#34;</span> &gt;&gt; /etc/sudoers
</span></span></code></pre></div><blockquote><p>⚠️ Replace <code>zakk</code> with your own username.</p></blockquote><hr><h2 id=17-ssh-optional>17. SSH (Optional)<a hidden class=anchor aria-hidden=true href=#17-ssh-optional>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>emerge net-misc/openssh
</span></span><span style=display:flex><span>systemctl enable sshd <span style=color:#f92672>&amp;&amp;</span> systemctl start sshd
</span></span></code></pre></div><hr><h2 id=18-reboot>18. Reboot<a hidden class=anchor aria-hidden=true href=#18-reboot>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>exit
</span></span><span style=display:flex><span>umount -R /mnt/gentoo
</span></span><span style=display:flex><span>reboot
</span></span></code></pre></div><hr><h1 id=-faq>💡 FAQ<a hidden class=anchor aria-hidden=true href=#-faq>#</a></h1><ul><li><strong>Slow downloads</strong> → choose nearest mirror.</li><li><strong>Wi‑Fi WPA3 unstable</strong> → try WPA2.</li><li><strong>Wayland vs X11</strong> → AMD/Intel: Wayland; Compatibility: X11.</li><li><strong>NVIDIA</strong> → new cards proprietary driver; old cards → nouveau.</li><li><strong>USE conflicts</strong> → check <code>emerge -pv</code> and add to <code>package.use</code>.</li><li><strong>License blocks</strong> → add to <code>package.license</code>.</li><li><strong>Need newer versions</strong> → use <code>package.accept_keywords</code>.</li><li><strong>Btrfs + LUKS/RAID</strong> → initramfs recommended.</li></ul><hr><h1 id=-references>📎 References<a hidden class=anchor aria-hidden=true href=#-references>#</a></h1><ul><li>Gentoo Handbook: <a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation>https://wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation</a></li><li>Bitbili: <a href=https://bitbili.net/gentoo-linux-installation-and-usage-tutorial.html>https://bitbili.net/gentoo-linux-installation-and-usage-tutorial.html</a></li><li>Rufus: <a href=https://rufus.ie/>https://rufus.ie/</a></li><li>Timezones: <a href=https://en.wikipedia.org/wiki/List_of_tz_database_time_zones>https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://zakk.au/tags/gentoo/>Gentoo</a></li><li><a href=https://zakk.au/tags/linux/>Linux</a></li><li><a href=https://zakk.au/tags/openrc/>OpenRC</a></li><li><a href=https://zakk.au/tags/systemd/>Systemd</a></li><li><a href=https://zakk.au/tags/kde/>KDE</a></li><li><a href=https://zakk.au/tags/gnome/>GNOME</a></li><li><a href=https://zakk.au/tags/ssh/>SSH</a></li><li><a href=https://zakk.au/tags/wayland/>Wayland</a></li><li><a href=https://zakk.au/tags/btrfs/>Btrfs</a></li><li><a href=https://zakk.au/tags/uefi/>UEFI</a></li><li><a href=https://zakk.au/tags/nvidia/>NVIDIA</a></li><li><a href=https://zakk.au/tags/amd/>AMD</a></li><li><a href=https://zakk.au/tags/intel/>Intel</a></li><li><a href=https://zakk.au/tags/iwd/>Iwd</a></li><li><a href=https://zakk.au/tags/wpa_supplicant/>Wpa_supplicant</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://zakk.au/>Zakk's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>